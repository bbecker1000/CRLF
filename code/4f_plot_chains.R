#plot chains

chain.data <- as_tibble(extract.samples(fit))



#remove warmup
chain.data <- chain.data[c(3001:6000),]
#add rownames
chain.data$sample <- 1:3000

MEAN <- chain.data %>% summarize(MEAN = mean(beta_Year))
chain.data %>%
  ggplot(aes(x=sample, y=beta_Year)) +
  geom_line(alpha = 0.2) +
  geom_hline(yintercept = as.numeric(MEAN), linetype = 2)

MEAN <- chain.data %>% summarize(MEAN = mean(beta_Year_2))
chain.data %>%
  ggplot(aes(x=sample, y=beta_Year_2)) +
  geom_line(alpha = 0.2) +
  geom_hline(yintercept = as.numeric(MEAN), linetype = 2)

MEAN <- chain.data %>% summarize(MEAN = mean(beta_Rain))
chain.data %>%
  ggplot(aes(x=sample, y=beta_Rain)) +
  geom_line(alpha = 0.2) +
  geom_hline(yintercept = as.numeric(MEAN), linetype = 2)

MEAN <- chain.data %>% summarize(MEAN = mean(beta_WaterTemp))
chain.data %>%
  ggplot(aes(x=sample, y=beta_WaterTemp)) +
  geom_line(alpha = 0.2) +
  geom_hline(yintercept = as.numeric(MEAN), linetype = 2)


#pairs plots
cowplot::plot_grid(
  
  chain.data %>%
    ggplot(aes(x=beta_Year, y=beta_WaterTemp)) +
    geom_point(color = "blue",alpha = 0.2)
  ,
  
  chain.data %>%
    ggplot(aes(x=beta_Year_2, y=beta_Rain)) +
    geom_point(color = "blue",alpha = 0.2)
  ,
  
  chain.data %>%
    ggplot(aes(x=beta_Rain, y=beta_WaterTemp)) +
    geom_point(color = "blue",alpha = 0.2)
  
)
